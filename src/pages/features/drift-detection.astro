---
import FeatureLayout from '../../layouts/FeatureLayout.astro'
import Terminal from '../../components/Terminal.astro'
import FeatureCard from '../../components/FeatureCard.astro'

const terminalLines = [
  { text: '', delay: 600 },
  { text: '<span class="text-buoy">âš“</span> Scanning for design drift...', type: 'output', delay: 800 },
  { text: '', delay: 1200 },
  { text: 'Found <span class="text-warning">31</span> issues across <span class="text-light">89</span> files', type: 'output', delay: 1400 },
  { text: '', delay: 1600 },
  { text: '<span class="text-critical font-semibold">CRITICAL (3)</span>', type: 'output', delay: 1800 },
  { text: 'â”œâ”€ Button.tsx:12 Missing aria-label', type: 'critical', delay: 2000 },
  { text: 'â”‚  <span class="text-success">â†’ Fix: Add aria-label=&#123;buttonText&#125;</span>', type: 'output', delay: 2200 },
  { text: 'â””â”€ Modal.tsx:45 Focus trap conflict', type: 'critical', delay: 2400 },
  { text: '   <span class="text-success">â†’ Fix: Use FocusTrap from design system</span>', type: 'output', delay: 2600 },
  { text: '', delay: 2800 },
  { text: '<span class="text-warning font-semibold">WARNING (12)</span>', type: 'output', delay: 3000 },
  { text: 'â”œâ”€ Card.tsx:8 Hardcoded #ffffff â†’ var(--color-bg)', type: 'warning', delay: 3200 },
  { text: 'â”œâ”€ Header.tsx:3 NavHeader deprecated â†’ Navigation', type: 'warning', delay: 3400 },
  { text: 'â””â”€ <span class="text-slate-dark">... and 10 more</span>', type: 'muted', delay: 3600 },
  { text: '', delay: 3800 },
  { text: '<span class="text-buoy font-semibold">Add to CI to catch at the PR â†’</span>', type: 'output', delay: 4000 },
]

const features = [
  {
    title: 'Hardcoded Values',
    description: 'Find colors, spacing, and fonts that bypass your design tokens.',
    icon: 'ğŸ¨',
    examples: ['#ff0000', '16px', 'Arial'],
    href: '/features/hardcoded-values'
  },
  {
    title: 'Duplicate Components',
    description: 'Detect similar components that should be consolidated.',
    icon: 'ğŸ“¦',
    examples: ['Button', 'ButtonNew', 'MyButton'],
    href: '/features/duplicate-detection'
  },
  {
    title: 'Naming Drift',
    description: 'Catch inconsistent naming conventions across your codebase.',
    icon: 'ğŸ·ï¸',
    examples: ['btn vs Button', 'color vs colour'],
    href: '/features/naming-consistency'
  },
  {
    title: 'Prop Mismatches',
    description: 'Find when the same prop has different types across components.',
    icon: 'ğŸ”§',
    examples: ['onClick vs onPress', 'size: string | number'],
    href: '/features/prop-consistency'
  },
  {
    title: 'Deprecated Patterns',
    description: 'Track components marked @deprecated still in use.',
    icon: 'âš ï¸',
    examples: ['@deprecated', 'legacy components'],
  },
  {
    title: 'Framework Sprawl',
    description: 'Detect multiple UI frameworks competing in your codebase.',
    icon: 'ğŸŒ',
    examples: ['React + Vue + ...'],
    href: '/features/framework-sprawl'
  },
  {
    title: 'Accessibility Issues',
    description: 'Find missing ARIA labels, focus traps, and contrast issues.',
    icon: 'â™¿',
    examples: ['Missing aria-label', 'Low contrast'],
    href: '/features/accessibility-checks'
  },
  {
    title: 'Orphaned Components',
    description: 'Components in code but missing from Figma or Storybook.',
    icon: 'ğŸ‘»',
    examples: ['In code, not in design'],
  },
  {
    title: 'Unused Tokens',
    description: 'Design tokens defined but never referenced in code.',
    icon: 'ğŸ—‘ï¸',
    examples: ['--color-unused', '--space-deprecated'],
  },
]

const relatedFeatures = [
  {
    title: 'Coverage Metrics',
    description: 'Measure design system adoption with real data',
    href: '/features/coverage'
  },
  {
    title: 'GitHub Action',
    description: 'Catch drift in every PR automatically',
    href: '/features/github-action'
  },
  {
    title: 'CI Integration',
    description: 'Add drift checks to your CI pipeline',
    href: '/features/ci'
  },
]
---

<FeatureLayout
  title="Design Drift Detection for React, Vue & Svelte | Buoy"
  description="Automatically detect when AI-generated code drifts from your design system. Find hardcoded values, naming inconsistencies, and deprecated patterns."
  keywords="design drift detection, AI code consistency, design system enforcement"
  heroTitle="Find drift. Catch it at the PR. Measure improvement."
  heroDescription="Not just another linter. Buoy finds design drift, blocks it in CI, and shows you the measurable improvement in your design system adoption."
>
  <!-- AI-Free Badge -->
  <div slot="hero-extra" class="flex justify-center mt-8">
    <div class="inline-flex items-center gap-3 px-5 py-3 bg-navy border border-success/30 rounded-xl">
      <div class="flex items-center gap-2">
        <span class="text-success text-lg">ğŸ”’</span>
        <span class="text-success font-semibold">100% Deterministic</span>
      </div>
      <span class="text-slate-dark">|</span>
      <span class="text-slate text-sm">No AI. No API keys. No data sent externally.</span>
    </div>
  </div>

  <!-- Drift Types Grid -->
  <section class="py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-light mb-4 text-center">All Drift Types</h2>
      <p class="text-slate text-center mb-12 max-w-2xl mx-auto">
        Comprehensive drift detection for modern frontend codebases
      </p>

      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {features.map((feature) => (
          <FeatureCard {...feature} />
        ))}
      </div>
    </div>
  </section>

  <!-- How It Works -->
  <section class="py-16 bg-navy">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-light mb-8 text-center">How Drift Detection Works</h2>

      <div class="grid md:grid-cols-3 gap-8">
        <div class="text-center">
          <div class="w-12 h-12 rounded-full bg-buoy/20 border-2 border-buoy flex items-center justify-center mx-auto mb-4 text-buoy font-bold">
            1
          </div>
          <h3 class="font-semibold text-light mb-2">Scan</h3>
          <p class="text-sm text-slate">
            Buoy parses your codebase to build a map of all components, props, and style values.
          </p>
        </div>

        <div class="text-center">
          <div class="w-12 h-12 rounded-full bg-buoy/20 border-2 border-buoy flex items-center justify-center mx-auto mb-4 text-buoy font-bold">
            2
          </div>
          <h3 class="font-semibold text-light mb-2">Analyze</h3>
          <p class="text-sm text-slate">
            Compares against your design system config to identify patterns that don't match.
          </p>
        </div>

        <div class="text-center">
          <div class="w-12 h-12 rounded-full bg-buoy/20 border-2 border-buoy flex items-center justify-center mx-auto mb-4 text-buoy font-bold">
            3
          </div>
          <h3 class="font-semibold text-light mb-2">Report</h3>
          <p class="text-sm text-slate">
            Outputs drift signals with severity, location, and suggested fixes.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Terminal Demo: Detect -->
  <section class="py-16">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-light mb-4 text-center">Step 1: Find Drift</h2>
      <p class="text-slate text-center mb-8 max-w-2xl mx-auto">
        Every issue includes the exact file, line, and what to change.
      </p>

      <Terminal
        command="buoy drift check"
        lines={terminalLines}
      />
    </div>
  </section>

  <!-- CI Enforcement Section -->
  <section class="py-16 bg-navy">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-light mb-4 text-center">Step 2: Catch at the PR</h2>
      <p class="text-slate text-center mb-8 max-w-2xl mx-auto">
        Add Buoy to CI. Design drift never reaches main.
      </p>

      <!-- GitHub PR Check Style Card -->
      <div class="bg-[#0d1117] border border-[#30363d] rounded-lg overflow-hidden shadow-xl">
        <div class="px-4 py-3 border-b border-[#30363d] flex items-center gap-2">
          <svg class="w-4 h-4 text-[#f85149]" fill="currentColor" viewBox="0 0 16 16">
            <path d="M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"/>
          </svg>
          <span class="text-[#f85149] font-medium text-sm">Buoy Design Check â€” 3 critical issues found</span>
        </div>
        <div class="divide-y divide-[#30363d]">
          <div class="px-4 py-3">
            <div class="flex items-center gap-2 mb-1">
              <span class="text-[#58a6ff] text-sm font-mono">src/components/Button.tsx</span>
              <span class="text-[#8b949e] text-sm">line 12</span>
            </div>
            <p class="text-[#c9d1d9] text-sm">Missing aria-label <code class="px-1.5 py-0.5 bg-[#161b22] rounded text-[#f85149] text-xs">Critical</code> â†’ Add <code class="px-1.5 py-0.5 bg-[#161b22] rounded text-[#7ee787] text-xs">aria-label=&#123;buttonText&#125;</code></p>
          </div>
          <div class="px-4 py-3">
            <div class="flex items-center gap-2 mb-1">
              <span class="text-[#58a6ff] text-sm font-mono">src/components/Card.tsx</span>
              <span class="text-[#8b949e] text-sm">line 8</span>
            </div>
            <p class="text-[#c9d1d9] text-sm">Hardcoded color <code class="px-1.5 py-0.5 bg-[#161b22] rounded text-[#f85149] text-xs">#ffffff</code> â†’ Use <code class="px-1.5 py-0.5 bg-[#161b22] rounded text-[#7ee787] text-xs">var(--color-bg)</code></p>
          </div>
          <div class="px-4 py-3">
            <div class="flex items-center gap-2 mb-1">
              <span class="text-[#58a6ff] text-sm font-mono">src/components/Header.tsx</span>
              <span class="text-[#8b949e] text-sm">line 3</span>
            </div>
            <p class="text-[#c9d1d9] text-sm">Deprecated component <code class="px-1.5 py-0.5 bg-[#161b22] rounded text-[#f85149] text-xs">NavHeader</code> â†’ Use <code class="px-1.5 py-0.5 bg-[#161b22] rounded text-[#7ee787] text-xs">Navigation</code></p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Actions Section -->
  <section class="py-16">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-light mb-4 text-center">What You Get</h2>
      <p class="text-slate text-center mb-12 max-w-2xl mx-auto">
        Clarity, not just data. Every scan ends with concrete next steps.
      </p>

      <div class="grid md:grid-cols-3 gap-6">
        <div class="bg-navy/50 border border-success/30 rounded-xl p-6">
          <div class="text-2xl mb-4">ğŸ›¡ï¸</div>
          <h3 class="font-semibold text-light mb-2">PR Checks</h3>
          <p class="text-sm text-slate mb-4">
            Catch drift at the PR. Every issue shows the exact token to use instead.
          </p>
          <code class="text-xs text-success bg-success/10 px-2 py-1 rounded">buoy check --ci</code>
        </div>

        <div class="bg-navy/50 border border-warning/30 rounded-xl p-6">
          <div class="text-2xl mb-4">ğŸ“‹</div>
          <h3 class="font-semibold text-light mb-2">Clear Explanations</h3>
          <p class="text-sm text-slate mb-4">
            Every issue includes the file, line, and exactly what needs to change.
          </p>
          <code class="text-xs text-warning bg-warning/10 px-2 py-1 rounded">buoy check --format detailed</code>
        </div>

        <div class="bg-navy/50 border border-buoy/30 rounded-xl p-6">
          <div class="text-2xl mb-4">ğŸ“ˆ</div>
          <h3 class="font-semibold text-light mb-2">Coverage Score</h3>
          <p class="text-sm text-slate mb-4">
            Track design system adoption over time. Show leadership real numbers.
          </p>
          <code class="text-xs text-buoy bg-buoy/10 px-2 py-1 rounded">buoy audit</code>
        </div>
      </div>
    </div>
  </section>

  <!-- The Happy Team -->
  <section class="py-16 bg-navy">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-light mb-8 text-center">Visible Outcomes</h2>

      <div class="grid sm:grid-cols-2 gap-6">
        <div class="bg-navy-dark border border-navy-light/20 rounded-xl p-6">
          <h3 class="font-semibold text-light mb-4 flex items-center gap-2">
            <span class="text-2xl">ğŸ‘©â€ğŸ’»</span> For Developers
          </h3>
          <ul class="space-y-2 text-sm text-slate">
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>No guessing â€” exact file, line, and fix</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>CI catches issues before they merge</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>PR checks catch issues before review</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Less time debating, more time building</span>
            </li>
          </ul>
        </div>

        <div class="bg-navy-dark border border-navy-light/20 rounded-xl p-6">
          <h3 class="font-semibold text-light mb-4 flex items-center gap-2">
            <span class="text-2xl">ğŸ“Š</span> For Leaders
          </h3>
          <ul class="space-y-2 text-sm text-slate">
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Real adoption numbers, not estimates</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Track improvement week over week</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Prove design system ROI with data</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Identify which teams need help</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Why Drift Matters -->
  <section class="py-16 bg-navy">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-light mb-8 text-center">Why Design Drift Matters</h2>

      <div class="grid sm:grid-cols-2 gap-6">
        <div class="bg-navy-dark border border-navy-light/20 rounded-xl p-6">
          <h3 class="font-semibold text-light mb-3">Without Drift Detection</h3>
          <ul class="space-y-2 text-sm text-slate">
            <li class="flex items-start gap-2">
              <span class="text-critical">âœ—</span>
              <span>Inconsistent UI across the app</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-critical">âœ—</span>
              <span>Design system becomes optional</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-critical">âœ—</span>
              <span>Harder to maintain and update</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-critical">âœ—</span>
              <span>No way to measure adoption</span>
            </li>
          </ul>
        </div>

        <div class="bg-navy-dark border border-success/30 rounded-xl p-6">
          <h3 class="font-semibold text-light mb-3">With Buoy</h3>
          <ul class="space-y-2 text-sm text-slate">
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Consistent, cohesive UI</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Design system enforcement</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Easy global updates via tokens</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-success">âœ“</span>
              <span>Real adoption metrics</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Related Features Slot -->
  <div slot="related" class="grid sm:grid-cols-3 gap-6 max-w-4xl mx-auto">
    {relatedFeatures.map((feature) => (
      <FeatureCard
        title={feature.title}
        description={feature.description}
        href={feature.href}
      />
    ))}
  </div>
</FeatureLayout>
